import { ComponentFixture, TestBed } from '@angular/core/testing';
import { HttpClientModule } from '@angular/common/http';
import { CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import { RouterTestingModule } from '@angular/router/testing';
import { LoadInvoiceComponent } from './load-invoice.component';


describe('AgreementsComponent', () => {
  let component: LoadInvoiceComponent;
  let fixture: ComponentFixture<LoadInvoiceComponent>;

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      schemas: [CUSTOM_ELEMENTS_SCHEMA],
      imports: [HttpClientModule, RouterTestingModule ], 
      declarations: [LoadInvoiceComponent]

    })
      .compileComponents();
  });

  beforeEach(() => {
    fixture = TestBed.createComponent(LoadInvoiceComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  afterEach(() => {
    jest.restoreAllMocks();
  });

  it('should create', () => {
    expect(component).toBeTruthy();
  });

  it('Prueba del LocalStorage Saving Ok', () => {
    jest.spyOn(Storage.prototype, 'getItem');
    jest.spyOn(Storage.prototype, 'setItem');
    const request = [
      {
        "NIT Proveedor": 8600001356,
        "Nombre Proveedor": "AZUL K SAS",
        "fileName": "Bdb_Factoring_V04.xlsm",
        "fileStatus": 1
      },
      {
        "fields_error": {},
        "noFactura": "B1599373"
      }
    ]
    const data = '[{"fileName":"Bdb_Factoring_V04.xlsm","data":[{"NRO FACTURA":"B1599373","CUFE/CUDE":"e6896bc717311343ffc304aa0aa7b3973aa76d908b59c131bb650f448d30a0b10a00f03f8ea66e664d87a9506b633f86","FECHA EXPEDICIÓN":"12/1/2022","FECHA VENCIMIENTO CLIENTE":"30/01/2023","Nombre Proveedor":"AZUL K SAS","NIT Proveedor":8600001356,"Nombre Deudor":"D1 SAS","NIT Deudor":9002769621,"VIN":"KNAB2512APT036852","Valor Factura RADIAN":112233306,"Valor Factura DESEMBOLSO":112233306},{"NRO FACTURA":"B1599375","CUFE/CUDE":"2bbb8daf769f330cb51c5d113816b4275fb217c54cc38665516ca3ce64904b13b440e11a62df6f44ac7fc03e75d8a1ea","FECHA EXPEDICIÓN":"12/1/2022","FECHA VENCIMIENTO CLIENTE":"30/01/2023","Nombre Proveedor":"AZUL K SAS","NIT Proveedor":8600001356,"Nombre Deudor":"D1 SAS","NIT Deudor":9002769621,"VIN":"KNAB2512APT036758","Valor Factura RADIAN":166693297,"Valor Factura DESEMBOLSO":166693297},{"NRO FACTURA":"B1599379","CUFE/CUDE":"8255d92c8a751cc390bf6c9d5625797a6042230ac21299d788720d608b23d8133cae9962655a56cec5cc1fcf3ef3cd6e","FECHA EXPEDICIÓN":"12/1/2022","FECHA VENCIMIENTO CLIENTE":"30/01/2023","Nombre Proveedor":"AZUL K SAS","NIT Proveedor":8600001356,"Nombre Deudor":"D1 SAS","NIT Deudor":9002769621,"VIN":"KNAB3512BPT032145","Valor Factura RADIAN":90743488,"Valor Factura DESEMBOLSO":90743488},{"NRO FACTURA":"ME256869","CUFE/CUDE":"ceeaeb4d4999dd80843557f6206eb6712cbb70412bd4754f66ad6a8cf2cfa81b6246249fdab1140b35752f17c8f07c9a","FECHA EXPEDICIÓN":"12/1/2022","FECHA VENCIMIENTO CLIENTE":"30/01/2023","Nombre Proveedor":"AZUL K SAS","NIT Proveedor":8600001356,"Nombre Deudor":"D1 SAS","NIT Deudor":9002769621,"VIN":"KNAB3512BPT031626","Valor Factura RADIAN":157009998,"Valor Factura DESEMBOLSO":157009998},{"NRO FACTURA":"ME257106","CUFE/CUDE":"9887cd7bb6059f77db6554ece0c51f5ade07bce7071b924c52168f6d444ab1fd3969e24da17ab41860838364a667fe8e","FECHA EXPEDICIÓN":"12/1/2022","FECHA VENCIMIENTO CLIENTE":"30/01/2023","Nombre Proveedor":"AZUL K SAS","NIT Proveedor":8600001356,"Nombre Deudor":"D1 SAS","NIT Deudor":9002769621,"VIN":"KNAB3512BPT032128","Valor Factura RADIAN":20691720,"Valor Factura DESEMBOLSO":20691720}]}]'
    localStorage.setItem("requestValidation", data);
    component.localStorageSaving(request);
    expect(localStorage.getItem).toHaveBeenCalled()
    expect(localStorage.setItem).toHaveBeenCalled()
    localStorage.clear();
  });

  it('Prueba del LocalStorage Saving Else', () => {
    jest.spyOn(Storage.prototype, 'getItem');
    jest.spyOn(Storage.prototype, 'setItem');
    const request = [
      {
        "NIT Proveedor": 8600001356,
        "Nombre Proveedor": "AZUL K SAS",
        "fileName": "Bdb_Factoring_V04.xlsm",
        "fileStatus": 1
      },
      {
        "fields_error": {},
        "noFactura": "B1599373"
      },
      {
        "fields_error": {},
        "noFactura": "B1599375"
      }
    ]
    component.localStorageSaving(request);
    expect(localStorage.getItem).toHaveBeenCalled()
    expect(localStorage.setItem).toHaveBeenCalled()
  });
  
  
  it('Prueba Push files to Html Ok', () => {
    component.fileName = "name";
    component.fileStatus=1;
    component.pushFilesToHtml();
    expect(component.localLoadedFiles.length).toEqual(0);
    component.data.push({
      status: 'success',
      filename: "nn",
      actions: [
        {
          "label":"Eliminar"
        }
      ]
    });
    component.pushFilesToHtml();
    expect(component.localLoadedFiles.length).toEqual(0);
    component.data.push({
      status: 'loading',
      filename: component.fileName,
      actions: [
        {
          "label":"Eliminar"
        }
      ]
    });
    component.pushFilesToHtml();
    expect(component.localLoadedFiles.length).toBeGreaterThan(0);
  });

  it('Prueba Push files to Html Error Duplicado', () => {
    component.fileStatus = -1;
    component.pdfStatus = -2;
    component.fileName = "name";
    component.data.push({
      status: 'loading',
      filename: component.fileName,
      actions: [
        {
          "label":"Eliminar"
        }
      ]
    });
    component.pushFilesToHtml();
    component.donwloadErrorsPdf();
    expect(component.trackingErrorArr.length).toBeGreaterThan(0);
  });

  it('Prueba Push files to Html Error', () => {
    component.fileStatus = -1;
    component.pdfStatus = 0;
    component.fileName = "name";
    component.data.push({
      status: 'loading',
      filename: component.fileName,
      actions: [
        {
          "label":"Eliminar"
        }
      ]
    });
    component.pushFilesToHtml();
    component.donwloadErrorsPdf();
    expect(component.trackingErrorArr.length).toBeGreaterThan(0);
  });



  it('Prueba Files to Delete', () => {
    const event = {
      detail: { card: { title: "title1" } }
    } as any;
    component.selectFilestoDelete(event);
    expect(component.filesToDelete[0]).toEqual(event.detail.card.title);
  });

  it('Prueba Files to Delete ok', () => {
    component.filesToDelete = ["title1"];
    const event = {
      detail:
      {
        card:
        {
          title: "title1"
        }
      }
    };
    component.selectFilestoDelete(event);
    expect(component.filesToDelete.length).toEqual(0);
  });

  it('Prueba deleteFiles reboot', () => {
    component.deleteFiles();
    expect(component.filesToDelete.length).toBe(0);
  });

  it('Prueba deleteFiles reboot 2', () => {
    component.filesToDelete = [{ name: "name1" }];
    component.loadedFiles = [{ name: "name1" }, { name: "name2" }];
    component.trackingErrorArr = [{ name: "name1" }, { name: "name2" }];
    component.deleteFiles();
    expect(component.loadedFiles.length).toBe(2);
    expect(component.trackingErrorArr.length).toBe(2);
    expect(component.filesToDelete.length).toBe(0);
    component.loadedFiles = [];
    component.trackingErrorArr = [];
  });

  it('Prueba excelToJson', () => {
    const event = {
      detail:
      {
        name: "name.xlsx"
      }
    };
    component.excelToJson(event);
    expect(component.fileName).toEqual("name.xlsx");
  });

  it('Prueba addFileLoadedSherpaComponent', () => {
    const event = {
      detail:
      {
        name: "name.xlsx"
      }
    };
    component.excelData = [];
    expect(component.addFileLoadedSherpaComponent(event)).toBe(false);
    component.data = []
    component.excelData = [""];
    component.addFileLoadedSherpaComponent(event);
    expect(component.data.length).toEqual(1);
  });

  it('Prueba funcion deleteFile', () => {
    const event = {
      detail:
      {
        id: 0,
        item: {
          status: "error"
        },
        name: "file Name"
      }
    };
    component.data.push({
      status: 'error',
      filename: "file Name",
      isDelete: 'true',
      message: "El archivo tiene errores en los campos.",
      linkButton: "Descargar carta de errores"
    });
    component.deleteFile(event);
    expect(component.data.length).toEqual(0);
  });

  it('Prueba deleteFile', () => {
    const event = {
      detail:
      {
        name: "name.xlsx",
        item: {
          status: "error"
        },
        id: 0
      }
    };
    component.numFilesErrors = 1;
    component.data = ['0'];
    expect(component.data.length).toEqual(1);
    component.deleteFile(event);
    expect(component.numFilesErrors).toBe(0);
    expect(component.data.length).toEqual(0);
    const event2 = {
      detail:
      {
        name: "name.xlsx",
        item: {
          status: "loading"
        },
        id: 0
      }
    };
    component.deleteFile(event2);
    expect(component.loadingFile).toBe(false);
    
  });

  it('Prueba compareArrays', () => {
    expect(component.compareArrays([])).toBe(false);
    expect(component.compareArrays(['NRO FACTURA', 'CUFE/CUDE', 'FECHA EXPEDICIÓN FACTURA',
      'FECHA VENCIMIENTO', 'NOMBRE PROVEEDOR', 'NIT PROVEEDOR', 'NOMBRE DEUDOR',
      'NIT DEUDOR', 'VIN', 'VALOR FACTURA RADIAN', 'VALOR FACTURA DESEMBOLSO'])).toBe(false);
    expect(component.compareArrays(['NRO FACTURA', 'CUFE/CUDE', 'FECHA EXPEDICIÓN FACTURA',
      'FECHA VENCIMIENTO PROVEEDOR', 'NOMBRE PROVEEDOR', 'NIT PROVEEDOR', 'NOMBRE DEUDOR',
      'NIT DEUDOR', 'VIN', 'VALOR FACTURA RADIAN', 'VALOR FACTURA DESEMBOLSO'])).toBe(true);
  });

  const eventFile = {
    detail:  {
      "result": "data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,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",
      name: "Factoring - BdB - LDF(HojaOculta).xlsx",
      type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
      lastModified: 1679071616364,
      lastModifiedDate:"2023-03-17T16:46:56.364Z",
      size: 13191,
      webkitRelativePath: ""

    }
  }
  it('Prueba funcion arrayHeaderFileExcel', () => {
    component.fileOnLoad(eventFile.detail)
    component.importFile(eventFile);
    component.waitResponseValidationExcel(1);
    expect(component.loadingFile).toBe(false)
    const header = {
      A1: { h: 'NRO FACTURA' },
      B1: { h: 'CUFE/CUDE' },
      C1: { h: 'FECHA EXPEDICIÓN FACTURA' },
      D1: { h: 'FECHA VENCIMIENTO PROVEEDOR' },
      E1: { h: 'NOMBRE PROVEEDOR' },
      F1: { h: 'NIT PROVEEDOR' },
      G1: { h: 'NOMBRE DEUDOR' },
      H1: { h: 'NIT DEUDOR' },
      I1: { h: 'VIN' },
      J1: { h: 'VALOR FACTURA RADIAN' },
      K1: { h: 'VALOR FACTURA DESEMBOLSO' }
    };
    const ar2 = ['NRO FACTURA', 'CUFE/CUDE', 'FECHA EXPEDICIÓN FACTURA',
      'FECHA VENCIMIENTO PROVEEDOR', 'NOMBRE PROVEEDOR', 'NIT PROVEEDOR', 'NOMBRE DEUDOR',
      'NIT DEUDOR', 'VIN', 'VALOR FACTURA RADIAN', 'VALOR FACTURA DESEMBOLSO']
    expect(component.arrayHeaderFileExcel(header)[0]).toBe(ar2[0]);
    expect(component.arrayHeaderFileExcel({A1: { h: 'NRO FACTURA' }})[0]).toBe(ar2[0]);
  });


  it('Probar  funcion fileOnLoad()', (done) => {
    done();
    component.fileOnLoad(eventFile.detail)
  });
  it('Prueba Split Invoice', async () => {
    const object = [
      {
          "NRO FACTURA": "0026656649",
          "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
          "FECHA EXPEDICIÓN FACTURA": 44999,
          "FECHA VENCIMIENTO PROVEEDOR": 45029,
          "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
          "NIT PROVEEDOR": "8600204395",
          "NOMBRE DEUDOR": "AGROEXPORT",
          "NIT DEUDOR": "8600484293",
          "VALOR FACTURA RADIAN": 20050000,
          "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      },
      {
        "NRO FACTURA": "0026656649",
        "CUFE/CUDE": "9bec6b45677322b365075dcc7c254e394116a41184ad9c29295925124b5f5846d4a6fc51dae2d6a6f93844b0603b29ca",
        "FECHA EXPEDICIÓN FACTURA": 44999,
        "FECHA VENCIMIENTO PROVEEDOR": 45029,
        "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
        "NIT PROVEEDOR": "8600204395",
        "NOMBRE DEUDOR": "AGROEXPORT",
        "NIT DEUDOR": "8600484293",
        "VALOR FACTURA RADIAN": 20050000,
        "VALOR FACTURA DESEMBOLSO": 20050000
      }
    ];
    const objectData = {
      "fileName": "MONOMEROS COLOMBO VENEZOLANOS - FACTORING - FEBRERO.xlsx",
      "data": object
    }
    const expected = [
      {
          "NIT PROVEEDOR": 8600204395,
          "NOMBRE PROVEEDOR": "MONOMEROS COLOMBO VENEZOLANOS",
          "fileName": "facturas_24_03_23.xlsx",
          "fileStatus": -1,
          "pdfStatus": -2
      },
      {
          "fields_error": {
              "CUFE/CUDE": [
                  "El CUFE/CUDE ya se encuentra en la base de datos."
              ],
              "NRO FACTURA": [
                  "la factura se encuentra duplicada para este proveedor",
                  "la factura se encuentra duplicada para este proveedor",
                  "la factura se encuentra duplicada para este proveedor",
                  "la factura se encuentra duplicada para este proveedor"
              ]
          },
          "noFactura": "0026656649",
          "nombreProveedor": "MONOMEROS COLOMBO VENEZOLANOS"
      }
    ];
    let serviceMock = {
      addExcel: async (data: any) => {
        return expected
      }
    }
    const splitResponse = await component.splitInvoice(objectData, serviceMock);
    expect(splitResponse[0]).toEqual(expected[0])
    expect(splitResponse[1]).toEqual(expected[1])
  })
});
